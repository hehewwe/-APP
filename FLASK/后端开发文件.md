# 项目后端服务（`myflask2.py`）技术说明文档

---

## 1. 项目概述

本项目基于 **Flask** 框架，提供“诈骗信息识别”App 的后端服务，包含**用户认证**与**文本分析**两大核心功能。

- **技术栈**：Python、Flask、Flask-CORS、Requests
- **服务端口**：5000
- **启动命令**：`python myflask2.py`

---

## 2. 核心设计逻辑

- **会话管理（Session）**
  - 使用 Flask 自带的 `session` 机制管理用户登录状态。
  - 用户登录成功后，`session` 中会记录 `username`，作为后续身份验证凭据。
  - 需要登录的接口会检查 `session` 是否存在 `username`。

- **逻辑内置**
  - 所有分析逻辑（如关键词诈骗判断）均在服务内部实现，不依赖外部 AI 服务。
  - 便于部署和维护，适合快速开发和迭代。

- **跨域支持**
  - 通过 Flask-CORS 插件，支持跨域请求，前端可直接调用。

---

## 3. API 接口说明

本服务共提供 **4 个** API 接口，供前端调用。

### 3.1 用户认证接口

#### a) 用户登录

- **路径**：`/try/login`
- **方法**：POST
- **请求体**（JSON）：
  ```json
  {
    "username": "用户的手机号",
    "password": "用户的密码"
  }
  ```
- **返回示例**：
  - 登录成功（HTTP 200）：
    ```json
    {
      "code": 200,
      "msg": "登录成功",
      "data": {
        "username": "登录的用户名"
      }
    }
    ```
  - 登录失败（HTTP 401）：
    ```json
    {
      "code": 401,
      "msg": "账号或密码错误"
    }
    ```

#### b) 检查登录状态

- **路径**：`/session`
- **方法**：GET
- **请求体**：无
- **返回示例**：
  - 已登录（HTTP 200）：
    ```json
    {
      "username": "当前登录的用户名"
    }
    ```
  - 未登录（HTTP 401）：
    ```json
    {
      "code": 401,
      "msg": "出错了，没登录"
    }
    ```

#### c) 退出登录

- **路径**：`/try/logout`
- **方法**：GET
- **请求体**：无
- **返回示例**（HTTP 200）：
  ```json
  {
    "code": 200,
    "msg": "成功退出登录!"
  }
  ```

---

### 3.2 核心功能接口

#### a) 文本分析接口（需登录）

- **路径**：`/analyze_text`
- **方法**：POST
- **请求体**（JSON）：
  ```json
  {
    "text": "需要分析的文本内容"
  }
  ```
- **返回示例**：
  - 分析成功（HTTP 200）：
    ```json
    {
      "编号": "一个随机生成的6位数字字符串，例如 '345678'",
      "诈骗类别": "分析出的具体诈骗类型，例如 '刷单返利类' 或 '正常信息'",
      "诈骗信息": "一段详细的分析描述文本"
    }
    ```
  - 未登录（HTTP 401）：
    ```json
    {
      "code": 401,
      "msg": "请先登录后再使用本功能"
    }
    ```
  - 服务器内部错误（HTTP 500）：
    ```json
    {
      "code": 500,
      "msg": "服务器内部错误"
    }
    ```

